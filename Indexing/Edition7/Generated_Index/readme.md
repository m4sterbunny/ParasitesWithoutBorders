See procedures and post indexing
NB the index generated contains duplicates and must be run through a duplicate drop.
There may still be duplicate range issues.
